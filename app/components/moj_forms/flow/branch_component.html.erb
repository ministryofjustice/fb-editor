<article id="<%= @item[:uuid] %>" class="flow-item flow-branch" data-fb-id="<%= @item[:uuid] %>">
  <%= image_pack_tag "diamond.svg",  usemap: "#thumbnail-#{@item[:uuid]}", alt: "", role: "presentation" %>
  <map name="thumbnail-<%= @item[:uuid] %>" aria-hidden="true">
    <area shape="poly" coords="0,72.5 100,0 200,72.5 100,145" alt="<%= @item[:title]-%>" role="presentation" href="<%= edit_branch_path(service.service_id, @item[:uuid]) %>" tabindex="-1">
  </map>
  <%= render(MojForms::Flow::FlowBranchLink.new(title:, url: edit_path )) %>
  <%= render partial: 'services/flow_branch_menu', locals: { item: @item } %>
  <ul class="flow-conditions">
    <% @item[:conditionals].each_with_index do |condition, index| %>
      <li class="flow-condition" data-from="<%= "#{@item[:uuid]}-#{index}" %>" data-next="<%= condition[:next] %>">
       <div class="flow-expressions">
          <% condition[:expressions].each_with_index do |expression, index| %>
            <% if expression[:operator].empty? && expression[:answer].empty? %>
              <span class="flow-expression" data-otherwise="true">
                <span class="question"><%= expression[:question] %></span>
              </span>
            <% else %>
              <span class="flow-expression" data-otherwise="false">
                <span class="question"><%= expression[:question] %></span>
                <span class="operator"><%= expression[:operator] %></span>
                <span class="answer"><%= expression[:answer] %></span>
              </span>
            <% end %>
            <% if index + 1 < condition[:expressions].size %>
              <span class="condition-operator"><%= t("branches.expression.and") -%></span>
            <% end %>
          <% end %>
        </div>
        <%= render partial: 'services/connection_menu', locals: { item: @item, condition: condition } %>
      </li>
    <% end %>
  </ul>
</article>
